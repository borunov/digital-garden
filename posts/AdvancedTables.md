# Advanced Tables

[Advanced Tables Help](https://github.com/tgrosinger/advanced-tables-obsidian/blob/main/docs/help.md)

### Формулы

Для того чтобы работал плагин нужно чтобы были началные и завершающие "палки"

```md
| Tables        | Are           | Cool  |
| ------------- |:-------------:| -----:|
| col 3 is      | right-aligned | $1600 |
| col 2 is      | centered      |   $12 |
| zebra stripes | are neat      |    $1 |
```
**строка формул должна вплотную примыкать к таблице**


[Formulas in Markdown Tables](https://github.com/tgrosinger/md-advanced-tables/blob/main/docs/formulas.md)
[How use Formulas in Markdown Tables](https://github.com/tgrosinger/advanced-tables-obsidian/blob/main/docs/help.md)


#### Ссылки на ячейки и строки

Строки всегда обозначаются `@` и столбцы `$`. Строки и столбцы могут быть указаны как абсолютные или относительные значения.

- `@1` означает первую строку, а `@5` означает 5-й ряд сверху.
- `$1` означает первый столбец, а `$5` означает пятый столбец слева.
- `@<` и `$<` означают первую строку и первый столбец соответственно.
- `@>` и `$>` означают последнюю строку и последний столбец соответственно.
-   `@I`ссылается на строку, отделяющую заголовок таблицы от тела таблицы.
- `@-1` означает строку над заполняемой ячейкой.
- `$+2` означает второй столбец справа от заполняемой ячейки.
-  @-1 означает "тот же столбец, на одну строку выше", и $+2 будет означать «та же строка, два столбца справа». 

#### Диапазоны
- `@2..$4` - некорректно.
- `@2$3..@5` - корректно
- `@2$3..@5$5` - корректно
- `$4..$6` - корректно (все строки в этих колонках)

Диапазоны можно использовать для выбора частей строки или столбца. 

- `@2$>..@5$>` - последняя колонка, с 2 до 5 строки. Arity `4x1`
- `@3$<..@3$5` - третяя строка, с 1 по 5 колонку. Arity `1x5`

Диапазоны также можно использовать для выбора не только строки или столбца. 

- `@<..@>` - с первой по последнюю строку (вся таблица).
- `@3$1..@4$3` - с 3 по 4 строку, с 1 по 3 колонку. Arity `2x3`

#### Сложить (вычитание - и умножение * деление / )

При добавлении хотя бы одно из указанных значений должно быть одной ячейкой. Формула не может добавлять один диапазон к другому.

(@2$3+@3$4) - корректно
(@2+@3$4) - корректно, сложить значение второй строки текущей ячейки с ячейкой @3 $4.
(@2$3+$4) - корректно, сложить значение @ 2 $ 3  значением в текущей строке, столбец $ 4.
(@2+@3) - корректно, добавьте значение в текущем столбце строки 2 к текущему столбцу строки 3.
@2$3+$4 - Некорректно- скобки отсутствуют.
<!-- TBLFM: $>=($2*$3) --> - премножить во всех строках
#### Условные операции

Условные выражения позволяют выбрать значение на основе сравнения двух входных данных. Например:

if(@3$4<@4$5, @2, @3)

В этом примере мы сравниваем значения, расположенные в ячейке @3$4 против клетки @4$5. Если первое меньше ( <) второй, то результатом будет первый параметр ( @2), иначе результатом будет второй параметр ( @3).

Сравнение может производиться только между ячейками, но не диапазонами.
Операторы сравнения

    < - Меньше, чем
    > - Больше чем
    <= - Меньше или равно
    >= - Больше или равно
    == - Равный
    != - Не равный
#### Сцепление и множественные формулы

В таблице может быть определено несколько формул. Это можно сделать двумя способами. В одной строке формулы можно объединить несколько формул в цепочку, разделив их ::. Например:

<!-- TBLFM: @2=@4::$1=$2 -->

В цепочке формулы будут оцениваться слева направо. Результирующая таблица после применения первой формулы будет использоваться в качестве входных данных для второй формулы. Это означает, что вторая формула может работать с вычисленными значениями из первой формулы.

Второй метод - с несколькими строками формул. 
Вычисление происходит снизу - вверх. Это означает, что верхняя формула может работать с вычисленными значениями из нижней формулы.

<!-- TBLFM: @2=@4 -->
<!-- TBLFM: $1=$2 -->

| Item              | Grams | Множ | Рез  |
|:----------------- | ----- | ---- | ---- |
| Whole Wheat Flour | 110   | 2    | 220  |
| Bread Flour       | 748   | 3    | 2244 |
| Warm Water        | 691   | 4    | 2764 |
| Salt              | 18    | 2    | 36   |
| Starter           | 40    | 1    | 40   |
| **Total Grams**   |       |      | 5304 |
<!-- TBLFM: @>$>=sum(@I..@>) -->
<!-- TBLFM: $>=($2*$3) -->

<!-- TBLFM: @>$>=sum(@I..@>) -->
<!-- TBLFM: $>=($2*$3) -->

<!-- TBLFM: @>$>=sum(@2..@6) -->

<!-- TBLFM: @7$4=sum(@2$4..@6$4) -->

<!-- TBLFM: @>$4=sum(@I..@-1) -->

<!-- TBLFM: $>=($2*$3) -->
#### Параметры форматирования

Вы можете дополнительно запросить вывод результата с определенным количеством десятичных знаков с помощью директивы форматирования. Например:

<!-- TBLFM: @>=(@I / @4$3);%.2f -->

В этом примере директива форматирования - это ;%.2fв конце. Без этого результатом были бы такие значения, как 0.14285714285714285, но поскольку мы запросили 2 десятичные дроби, вместо этого результаты будут 0.14. 

#### Примеры

<!-- TBLFM: @4$1=sum(@2$1..@3$1) -->
<!-- TBLFM: @4$2=sum(@2$2..@3$2) -->
<!-- TBLFM: @4$3=sum(@2$3..@3$3) -->
<!-- TBLFM: @4$4=sum(@4$1..@4$4) -->

| Item              | Grams |
| ----------------- | ----- |
| Whole Wheat Flour | 110   |
| Bread Flour       | 748   |
| Warm Water        | 691   |
| Salt              | 18    |
| Starter           | 40    |
| **Total Grams**   | 1607  |
<!-- TBLFM: @>$2=sum(@I..@-1) -->



| One | Two | Three |     |
|:--- | --- | ----- | --- |
| 1   | 2   | 89    |     |
| 4   | 5   | 7     |     |
| 5   | 7   | 96    | 108 |
<!-- TBLFM: @>$1=sum(@2$1..@3$1) -->
<!-- TBLFM: @>$2=sum(@2$2..@3$2) -->
<!-- TBLFM: @>$3=sum(@2$3..@3$3) -->
<!-- TBLFM: @>$>=sum(@>$1..@>$>) -->


<!-- TBLFM: @4$1=sum(@2$1..@3$1) -->
<!-- TBLFM: @4$2=sum(@2$2..@3$2) -->
<!-- TBLFM: @4$3=sum(@2$3..@3$3) -->
<!-- TBLFM: @4$4=sum(@4$1..@4$4) -->
